<!DOCTYPE html>
<html>
<head>
    <title>Edit Backup Job - Backup Manager</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="/static/nav.js"></script>
</head>
<body>
    <div class="container">
        <div id="navigation"></div>
        
        <h1>Edit Backup Job: {{JOB_NAME}}</h1>
        
        <form method="post" action="/save-job">
            <input type="hidden" name="job_name" value="{{JOB_NAME}}">
            
            <div class="form-group">
                <label for="source">Source Path:</label>
                <input type="text" id="source" name="source" required value="{{SOURCE}}">
                <div class="help-text">
                    <strong>Local:</strong> /path/to/files OR <strong>Remote (SSH):</strong> user@hostname:/path/to/files
                </div>
            </div>
            
            <div class="form-group" id="ssh-options" style="display: none;">
                <div style="background-color: #3a3a3a; padding: 15px; border-radius: 4px; margin-bottom: 15px;">
                    <h4 style="margin-top: 0; color: #4a9eff;">SSH Remote Source</h4>
                    <p style="color: #e0e0e0;">
                        This job uses SSH to access a remote source. Ensure passwordless SSH access is configured.
                    </p>
                </div>
            </div>
            
            <div class="form-group">
                <label for="includes">Include Patterns (one per line):</label>
                <textarea id="includes" name="includes" placeholder="Leave empty to include everything, or specify patterns like:
**/*.jpg
documents/**
*.pdf">{{INCLUDES}}</textarea>
                <div class="help-text">Use rsync patterns. Leave empty to include all files.</div>
            </div>
            
            <div class="form-group">
                <label for="excludes">Exclude Patterns (one per line):</label>
                <textarea id="excludes" name="excludes" placeholder="Patterns to exclude:
*.tmp
*.log
cache/**
.git/**">{{EXCLUDES}}</textarea>
                <div class="help-text">Use rsync patterns to exclude files/directories.</div>
            </div>
            
            <div class="form-group">
                <label for="schedule">Schedule:</label>
                <select id="schedule" name="schedule">
                    <option value="manual">Manual Only</option>
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                </select>
                <script>
                    // Set selected option
                    document.getElementById('schedule').value = '{{SCHEDULE}}';
                </script>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" name="enabled" value="true" {{ENABLED_CHECKED}}> Enabled
                </label>
            </div>
            
            <input type="submit" value="Update Backup Job" class="button button-success">
            <a href="/" class="button" style="background-color: #6c757d;">Cancel</a>
        </form>
        
        <form method="post" action="/delete-job" style="margin-top: 20px;" onsubmit="return confirm('Are you sure you want to delete this backup job?')">
            <input type="hidden" name="job_name" value="{{JOB_NAME}}">
            <input type="submit" value="Delete Job" class="button button-danger">
        </form>
    </div>
    <script>
        // Show SSH options when remote source is detected
        function checkSSHSource() {
            const source = document.getElementById('source').value;
            const sshOptions = document.getElementById('ssh-options');
            
            // Check if source looks like user@host:/path
            const isRemoteSource = /^[^@]+@[^:]+:/.test(source);
            
            if (isRemoteSource) {
                sshOptions.style.display = 'block';
            } else {
                sshOptions.style.display = 'none';
            }
        }
        
        // Check on page load and input changes
        document.addEventListener('DOMContentLoaded', checkSSHSource);
        document.getElementById('source').addEventListener('input', checkSSHSource);
    </script>
</body>
</html>
