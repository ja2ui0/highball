<!DOCTYPE html>
<html>
<head>
    <title>Inspect {{ job_name }} - Highball</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="{{ theme_css_path }}">
    <script src="/static/htmx.min.js"></script>
    <script src="/static/nav.js"></script>
    <script src="/static/backup-browser.js"></script>
    <script src="/static/restore-core.js"></script>
    <script src="/static/restore-restic.js"></script>
    <script src="/static/job-inspect.js"></script>
</head>
<body>
    <div class="container">
        <div id="navigation"></div>
        
        <h1>Inspect Job: {{ job_name }}</h1>
        <p class="job-type-info">Job Type: <strong>{{ job_type }}</strong></p>
        
        <!-- Job Status Section -->
        <div class="section-container">
            <h2 class="section-header">Job Status</h2>
            
            <div class="form-group">
                <label>Last Run:</label>
                <div style="background-color: var(--bg-darker); padding: 12px; border-radius: 4px; font-family: monospace;">
                    {{ last_run }}
                </div>
            </div>
            
            <div class="form-group">
                <label>Status:</label>
                <div style="background-color: var(--bg-darker); padding: 12px; border-radius: 4px; font-family: monospace;">
                    {{ status }}
                </div>
            </div>
            
            <div class="form-group">
                <label>Message:</label>
                <div style="background-color: var(--bg-darker); padding: 12px; border-radius: 4px; font-family: monospace; word-break: break-word;">
                    {{ message }}
                </div>
            </div>
        </div>
        
        <!-- Backup Browser Component -->
        <div class="section-container">
            <h2 class="section-header">Backup Browser</h2>
            
            {% include 'partials/repository_status_check.html' %}
            
        </div>
        
        <!-- Progress display inline in restore controls -->
        <div id="restoreProgress" class="restore-progress hidden">
            <div class="progress-section">
                <h4>Restore in Progress</h4>
                <div id="progressBar" class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                </div>
                <div id="progressText">Starting restore...</div>
            </div>
        </div>
        
        <!-- Job Logs -->
        <div class="section-container">
            <h2 class="section-header">Job Logs</h2>
            {% include 'partials/log_controls.html' %}
            
            <div id="logContent" class="log-viewer">{{ job_log_content }}</div>
        </div>
    </div>
    
    <script>
        // Initialize backup browser when page loads
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof loadBackupJob === 'function') {
                loadBackupJob();
            }
        });
    </script>
</body>
</html>