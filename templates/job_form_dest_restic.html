            <div id="dest_restic" class="hidden">
                <div class="form-group">
                    <label for="restic_repo_type">Repository Type:</label>
                    <select id="restic_repo_type" name="restic_repo_type" onchange="showResticRepoFields()">
                        <option value="">Select repository type...</option>
                        <option value="local">Local Path</option>
                        <option value="rest">REST Server</option>
                        <option value="s3">Amazon S3</option>
                        <option value="rclone">rclone Remote</option>
                        <option value="sftp">SFTP</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="restic_password">Repository Password:</label>
                    <div class="password-input-container">
                        <input type="password" id="restic_password" name="restic_password" value="{{RESTIC_PASSWORD}}" placeholder="Strong repository password" required>
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('restic_password')" aria-label="Toggle password visibility">
                            <span class="password-toggle-icon" data-target="restic_password">Show</span>
                        </button>
                    </div>
                    <div class="help-text">This password encrypts your entire backup repository. Store it securely!</div>
                </div>
                
                <div id="restic_local" class="hidden mt-10">
                    <label for="restic_local_path">Local Repository Path:</label>
                    <input type="text" name="restic_local_path" value="{{RESTIC_LOCAL_PATH}}" placeholder="/var/backups/restic-repo">
                    <div class="help-text config-note">
                        <strong>Local Path Requirements:</strong><br>
                        • Must exist and persist via bind mount or named volume<br>
                        • Data will be lost when container restarts without proper mounting<br>
                        • Example: <code>-v /host/backup:/var/backups</code>
                    </div>
                </div>
                
                <div id="restic_rest" class="hidden mt-10">
                    <div class="form-group">
                        <label for="restic_rest_hostname">REST Server Hostname:</label>
                        <input type="text" name="restic_rest_hostname" value="{{RESTIC_REST_HOSTNAME}}" placeholder="backup.example.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="restic_rest_port">Port:</label>
                        <input type="number" name="restic_rest_port" value="{{RESTIC_REST_PORT}}" placeholder="8000">
                    </div>
                    
                    <div class="form-group">
                        <label for="restic_rest_path">Path (optional):</label>
                        <input type="text" name="restic_rest_path" value="{{RESTIC_REST_PATH}}" placeholder="/my-backups">
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" name="restic_rest_use_https" {{RESTIC_REST_USE_HTTPS_CHECKED}}> Use HTTPS
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label for="restic_rest_username">Username (optional):</label>
                        <input type="text" name="restic_rest_username" value="{{RESTIC_REST_USERNAME}}" placeholder="backup-user">
                    </div>
                    
                    <div class="form-group">
                        <label for="restic_rest_password">Password (optional):</label>
                        <input type="password" name="restic_rest_password" value="{{RESTIC_REST_PASSWORD}}" placeholder="server-password">
                        <div class="help-text">Credentials are optional - some REST servers don't require authentication</div>
                    </div>
                    
                    <div class="help-text">
                        <strong>Generated URI:</strong> <span id="rest_uri_preview">rest:https://hostname:8000/path</span>
                    </div>
                </div>
                
                <div id="restic_s3" class="hidden mt-10">
                    <label for="restic_s3_endpoint">S3 Endpoint:</label>
                    <input type="text" name="restic_s3_endpoint" value="{{RESTIC_S3_ENDPOINT}}" placeholder="s3.amazonaws.com">
                    
                    <label for="restic_s3_bucket">Bucket Name:</label>
                    <input type="text" name="restic_s3_bucket" value="{{RESTIC_S3_BUCKET}}" placeholder="my-backup-bucket">
                    
                    <label for="restic_s3_prefix">Prefix (optional):</label>
                    <input type="text" name="restic_s3_prefix" value="{{RESTIC_S3_PREFIX}}" placeholder="restic">
                    
                    <label for="restic_aws_access_key">AWS Access Key ID:</label>
                    <input type="text" name="restic_aws_access_key" value="{{RESTIC_AWS_ACCESS_KEY}}" placeholder="AKIAIOSFODNN7EXAMPLE">
                    
                    <label for="restic_aws_secret_key">AWS Secret Access Key:</label>
                    <input type="password" name="restic_aws_secret_key" value="{{RESTIC_AWS_SECRET_KEY}}" placeholder="wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY">
                    
                    <div class="help-text">
                        <strong>Generated URI:</strong> <span id="s3_uri_preview">s3:s3.amazonaws.com/bucket/prefix</span>
                    </div>
                </div>
                
                <div id="restic_rclone" class="hidden mt-10">
                    <label for="restic_rclone_remote">rclone Remote Name:</label>
                    <input type="text" name="restic_rclone_remote" value="{{RESTIC_RCLONE_REMOTE}}" placeholder="gdrive">
                    
                    <label for="restic_rclone_path">Path:</label>
                    <input type="text" name="restic_rclone_path" value="{{RESTIC_RCLONE_PATH}}" placeholder="backups">
                    
                    <div class="help-text config-note">
                        <strong>rclone Setup Required:</strong><br>
                        • Run <code>rclone config</code> on source system to configure remote<br>
                        • Test with <code>rclone listremotes</code> and <code>rclone lsd remote:</code><br>
                        • Common remotes: Google Drive, Dropbox, OneDrive, S3-compatible services
                    </div>
                    
                    <div class="help-text">
                        <strong>Generated URI:</strong> <span id="rclone_uri_preview">rclone:remote:path</span>
                    </div>
                </div>
                
                <div id="restic_sftp" class="hidden mt-10">
                    <label for="restic_sftp_hostname">SFTP Hostname:</label>
                    <input type="text" name="restic_sftp_hostname" value="{{RESTIC_SFTP_HOSTNAME}}" placeholder="sftp.example.com">
                    
                    <label for="restic_sftp_username">Username:</label>
                    <input type="text" name="restic_sftp_username" value="{{RESTIC_SFTP_USERNAME}}" placeholder="backup-user">
                    
                    <label for="restic_sftp_path">Path:</label>
                    <input type="text" name="restic_sftp_path" value="{{RESTIC_SFTP_PATH}}" placeholder="/home/backup/repo">
                    
                    <div class="help-text">
                        <strong>Generated URI:</strong> <span id="sftp_uri_preview">sftp:user@hostname:/path</span>
                    </div>
                </div>
                
                <div class="mt-15">
                    <button type="button" onclick="validateRestic()" class="button button-warning">Validate Restic Configuration</button>
                    <button type="button" id="init_restic_button" onclick="initializeRestic()" class="button button-primary ml-10 hidden">Initialize Repository</button>
                </div>
                
                <div class="validation-section mt-15">
                    <h3 class="validation-header">Validation Results</h3>
                    <div class="validation-content">
                        <span id="restic_validation_status"></span>
                        <div id="restic_validation_details" class="validation-details hidden"></div>
                    </div>
                </div>
                
                <!-- Repository Maintenance -->
                <div class="mt-15">
                    <!-- Hidden field to store maintenance mode -->
                    <input type="hidden" id="restic_maintenance" name="restic_maintenance" value="{{RESTIC_MAINTENANCE_MODE}}">
                    
                    <!-- First Toggle: Auto / User -->
                    <div class="toggle-switch">
                        <span class="toggle-switch-label">Repository Maintenance:</span>
                        <div class="toggle-container {{MAINTENANCE_FIRST_TOGGLE_CLASS}}" id="maintenanceFirstToggle" onclick="toggleMaintenanceFirst()">
                            <div class="toggle-slider"></div>
                            <span class="toggle-option left">Auto</span>
                            <span class="toggle-option right">User</span>
                        </div>
                    </div>
                    
                    <!-- Auto Mode Help Text -->
                    <div id="auto_help_text" class="help-text">
                        Automatically remove old snapshots and verify repository integrity. 
                        Runs daily discard (forget+prune) at 3am and weekly check on Sundays at 2am.
                    </div>
                    
                    <!-- User Mode Section -->
                    <div id="user_mode_section" class="hidden">
                        <div class="help-text">
                            User settings below:
                        </div>
                        
                        <!-- Second Toggle: Config / Off -->
                        <div class="toggle-switch mt-10">
                            <span class="toggle-switch-label">Manual Options:</span>
                            <div class="toggle-container {{MAINTENANCE_SECOND_TOGGLE_CLASS}}" id="maintenanceSecondToggle" onclick="toggleMaintenanceSecond()">
                                <div class="toggle-slider"></div>
                                <span class="toggle-option left">Config</span>
                                <span class="toggle-option right">Off</span>
                            </div>
                        </div>
                        
                        <!-- Config Mode Help Text -->
                        <div id="config_help_text" class="help-text">
                            Please set your options below, or leave blank to honor defaults.
                        </div>
                        
                        <!-- Off Mode Help Text -->
                        <div id="off_help_text" class="help-text hidden">
                            <strong>WARNING:</strong> No maintenance will be performed on this repository. It will grow indefinitely without manual intervention.
                        </div>
                        
                        <!-- Manual Configuration Options -->
                        <div id="manual_config_options" class="mt-15">
                            <div class="validation-section">
                                <div class="form-group">
                                    <label for="maintenance_discard_schedule">Discard Schedule (cron format):</label>
                                    <input type="text" id="maintenance_discard_schedule" name="maintenance_discard_schedule" 
                                           value="{{MAINTENANCE_DISCARD_SCHEDULE}}" placeholder="0 3 * * *">
                                    <div class="help-text">When to remove old snapshots and reclaim space. Default: daily at 3am (0 3 * * *)</div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="maintenance_check_schedule">Check Schedule (cron format):</label>
                                    <input type="text" id="maintenance_check_schedule" name="maintenance_check_schedule" 
                                           value="{{MAINTENANCE_CHECK_SCHEDULE}}" placeholder="0 2 * * 0">
                                    <div class="help-text">When to verify repository integrity. Default: weekly Sunday 2am (0 2 * * 0)</div>
                                </div>
                                
                                <div class="form-group">
                                    <h4>Retention Policy</h4>
                                    <div class="help-text">How many snapshots to keep. Leave blank to use defaults.</div>
                                    
                                    <div class="flex-row mt-15">
                                        <div class="flex-1">
                                            <label for="keep_last">Keep Last:</label>
                                            <input type="number" id="keep_last" name="keep_last" value="{{KEEP_LAST}}" placeholder="7" min="1">
                                            <div class="help-text">Default: 7</div>
                                        </div>
                                        
                                        <div class="flex-1">
                                            <label for="keep_hourly">Keep Hourly:</label>
                                            <input type="number" id="keep_hourly" name="keep_hourly" value="{{KEEP_HOURLY}}" placeholder="6" min="0">
                                            <div class="help-text">Default: 6</div>
                                        </div>
                                        
                                        <div class="flex-1">
                                            <label for="keep_daily">Keep Daily:</label>
                                            <input type="number" id="keep_daily" name="keep_daily" value="{{KEEP_DAILY}}" placeholder="7" min="0">
                                            <div class="help-text">Default: 7</div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex-row mt-10">
                                        <div class="flex-1">
                                            <label for="keep_weekly">Keep Weekly:</label>
                                            <input type="number" id="keep_weekly" name="keep_weekly" value="{{KEEP_WEEKLY}}" placeholder="4" min="0">
                                            <div class="help-text">Default: 4</div>
                                        </div>
                                        
                                        <div class="flex-1">
                                            <label for="keep_monthly">Keep Monthly:</label>
                                            <input type="number" id="keep_monthly" name="keep_monthly" value="{{KEEP_MONTHLY}}" placeholder="6" min="0">
                                            <div class="help-text">Default: 6</div>
                                        </div>
                                        
                                        <div class="flex-1">
                                            <label for="keep_yearly">Keep Yearly:</label>
                                            <input type="number" id="keep_yearly" name="keep_yearly" value="{{KEEP_YEARLY}}" placeholder="0" min="0">
                                            <div class="help-text">Default: 0</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>